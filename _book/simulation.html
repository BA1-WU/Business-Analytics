<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Simulation | Business Analytics</title>
  <meta name="description" content="An Introduction to Statistics Using R" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Simulation | Business Analytics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An Introduction to Statistics Using R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Simulation | Business Analytics" />
  
  <meta name="twitter:description" content="An Introduction to Statistics Using R" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="exploratory-factor-analysis.html"/>
<link rel="next" href="linear-programming.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">BA</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html"><i class="fa fa-check"></i>Course materials</a>
<ul>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html#main-reference"><i class="fa fa-check"></i>Main reference</a></li>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html#further-readings"><i class="fa fa-check"></i>Further readings</a></li>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html#datacamp"><i class="fa fa-check"></i>DataCamp</a></li>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html#other-web-resources"><i class="fa fa-check"></i>Other web-resources</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting started</a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-started.html"><a href="getting-started.html#how-to-download-and-install-r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> How to download and install R and RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html#getting-help"><i class="fa fa-check"></i><b>1.2</b> Getting help</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started.html"><a href="getting-started.html#functions"><i class="fa fa-check"></i><b>1.3</b> Functions</a></li>
<li class="chapter" data-level="1.4" data-path="getting-started.html"><a href="getting-started.html#packages"><i class="fa fa-check"></i><b>1.4</b> Packages</a></li>
<li class="chapter" data-level="1.5" data-path="getting-started.html"><a href="getting-started.html#a-typical-r-session"><i class="fa fa-check"></i><b>1.5</b> A typical R session</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-handling.html"><a href="data-handling.html"><i class="fa fa-check"></i><b>2</b> Data handling</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-handling.html"><a href="data-handling.html#basic-data-handling"><i class="fa fa-check"></i><b>2.1</b> Basic data handling</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-handling.html"><a href="data-handling.html#creating-objects"><i class="fa fa-check"></i><b>2.1.1</b> Creating objects</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-handling.html"><a href="data-handling.html#data-types"><i class="fa fa-check"></i><b>2.1.2</b> Data types</a></li>
<li class="chapter" data-level="2.1.3" data-path="data-handling.html"><a href="data-handling.html#data-structures"><i class="fa fa-check"></i><b>2.1.3</b> Data structures</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-handling.html"><a href="data-handling.html#advanced-data-handling"><i class="fa fa-check"></i><b>2.2</b> Advanced data handling</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-handling.html"><a href="data-handling.html#the-dplyr-package"><i class="fa fa-check"></i><b>2.2.1</b> The dplyr package</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-handling.html"><a href="data-handling.html#dealing-with-strings"><i class="fa fa-check"></i><b>2.2.2</b> Dealing with strings</a></li>
<li class="chapter" data-level="2.2.3" data-path="data-handling.html"><a href="data-handling.html#case-study"><i class="fa fa-check"></i><b>2.2.3</b> Case study</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-handling.html"><a href="data-handling.html#data-import-and-export"><i class="fa fa-check"></i><b>2.3</b> Data import and export</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data-handling.html"><a href="data-handling.html#getting-data-for-this-course"><i class="fa fa-check"></i><b>2.3.1</b> Getting data for this course</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-handling.html"><a href="data-handling.html#import-data-created-by-other-software-packages"><i class="fa fa-check"></i><b>2.3.2</b> Import data created by other software packages</a></li>
<li class="chapter" data-level="2.3.3" data-path="data-handling.html"><a href="data-handling.html#export-data"><i class="fa fa-check"></i><b>2.3.3</b> Export data</a></li>
<li class="chapter" data-level="2.3.4" data-path="data-handling.html"><a href="data-handling.html#import-data-from-the-web"><i class="fa fa-check"></i><b>2.3.4</b> Import data from the Web</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="summarizing-data.html"><a href="summarizing-data.html"><i class="fa fa-check"></i><b>3</b> Summarizing data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="summarizing-data.html"><a href="summarizing-data.html#summary-statistics"><i class="fa fa-check"></i><b>3.1</b> Summary statistics</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="summarizing-data.html"><a href="summarizing-data.html#categorical-variables"><i class="fa fa-check"></i><b>3.1.1</b> Categorical variables</a></li>
<li class="chapter" data-level="3.1.2" data-path="summarizing-data.html"><a href="summarizing-data.html#continuous-variables"><i class="fa fa-check"></i><b>3.1.2</b> Continuous variables</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="summarizing-data.html"><a href="summarizing-data.html#data-visualization"><i class="fa fa-check"></i><b>3.2</b> Data visualization</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="summarizing-data.html"><a href="summarizing-data.html#categorical-variables-1"><i class="fa fa-check"></i><b>3.2.1</b> Categorical variables</a></li>
<li class="chapter" data-level="3.2.2" data-path="summarizing-data.html"><a href="summarizing-data.html#continuous-variables-1"><i class="fa fa-check"></i><b>3.2.2</b> Continuous variables</a></li>
<li class="chapter" data-level="3.2.3" data-path="summarizing-data.html"><a href="summarizing-data.html#saving-plots"><i class="fa fa-check"></i><b>3.2.3</b> Saving plots</a></li>
<li class="chapter" data-level="3.2.4" data-path="summarizing-data.html"><a href="summarizing-data.html#additional-options"><i class="fa fa-check"></i><b>3.2.4</b> Additional options</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="summarizing-data.html"><a href="summarizing-data.html#writing-reports-using-r-markdown"><i class="fa fa-check"></i><b>3.3</b> Writing reports using R-Markdown</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="summarizing-data.html"><a href="summarizing-data.html#creating-a-new-r-markdown-document"><i class="fa fa-check"></i><b>3.3.1</b> Creating a new R-Markdown document</a></li>
<li class="chapter" data-level="3.3.2" data-path="summarizing-data.html"><a href="summarizing-data.html#text-and-equations"><i class="fa fa-check"></i><b>3.3.2</b> Text and Equations</a></li>
<li class="chapter" data-level="3.3.3" data-path="summarizing-data.html"><a href="summarizing-data.html#r-code"><i class="fa fa-check"></i><b>3.3.3</b> R-Code</a></li>
<li class="chapter" data-level="3.3.4" data-path="summarizing-data.html"><a href="summarizing-data.html#latex-math"><i class="fa fa-check"></i><b>3.3.4</b> LaTeX Math</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html"><i class="fa fa-check"></i><b>4</b> Introduction to Statistical Inference</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#if-we-knew-it-all"><i class="fa fa-check"></i><b>4.1</b> If we knew it all</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#sampling-from-a-known-population"><i class="fa fa-check"></i><b>4.1.1</b> Sampling from a known population</a></li>
<li class="chapter" data-level="4.1.2" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>4.1.2</b> Standard error of the mean</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>4.2</b> The Central Limit Theorem</a></li>
<li class="chapter" data-level="4.3" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#using-what-we-actually-know"><i class="fa fa-check"></i><b>4.3</b> Using what we actually know</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#confidence-intervals-for-the-sample-mean"><i class="fa fa-check"></i><b>4.3.1</b> Confidence Intervals for the Sample Mean</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#summary"><i class="fa fa-check"></i><b>4.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>5</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="5.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#the-null-hypothesis"><i class="fa fa-check"></i><b>5.1.1</b> The null hypothesis</a></li>
<li class="chapter" data-level="5.1.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#statistical-inference-on-a-sample"><i class="fa fa-check"></i><b>5.1.2</b> Statistical inference on a sample</a></li>
<li class="chapter" data-level="5.1.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#choosing-the-right-test"><i class="fa fa-check"></i><b>5.1.3</b> Choosing the right test</a></li>
<li class="chapter" data-level="5.1.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#summary-1"><i class="fa fa-check"></i><b>5.1.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-sample-t-test"><i class="fa fa-check"></i><b>5.2</b> One sample t-test</a></li>
<li class="chapter" data-level="5.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#comparing-two-means"><i class="fa fa-check"></i><b>5.3</b> Comparing two means</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#independent-means-t-test"><i class="fa fa-check"></i><b>5.3.1</b> Independent-means t-test</a></li>
<li class="chapter" data-level="5.3.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#dependent-means-t-test"><i class="fa fa-check"></i><b>5.3.2</b> Dependent-means t-test</a></li>
<li class="chapter" data-level="5.3.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#further-considerations"><i class="fa fa-check"></i><b>5.3.3</b> Further considerations</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#comparing-several-means"><i class="fa fa-check"></i><b>5.4</b> Comparing several means</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#introduction-1"><i class="fa fa-check"></i><b>5.4.1</b> Introduction</a></li>
<li class="chapter" data-level="5.4.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#decomposing-variance"><i class="fa fa-check"></i><b>5.4.2</b> Decomposing variance</a></li>
<li class="chapter" data-level="5.4.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-way-anova"><i class="fa fa-check"></i><b>5.4.3</b> One-way ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#non-parametric-tests"><i class="fa fa-check"></i><b>5.5</b> Non-parametric tests</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#mann-whitney-u-test-a.k.a.-wilcoxon-rank-sum-test"><i class="fa fa-check"></i><b>5.5.1</b> Mann-Whitney U Test (a.k.a. Wilcoxon rank-sum test)</a></li>
<li class="chapter" data-level="5.5.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>5.5.2</b> Wilcoxon signed-rank test</a></li>
<li class="chapter" data-level="5.5.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#kruskal-wallis-test"><i class="fa fa-check"></i><b>5.5.3</b> Kruskal-Wallis test</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#categorical-data"><i class="fa fa-check"></i><b>5.6</b> Categorical data</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#confidence-intervals-for-proportions"><i class="fa fa-check"></i><b>5.6.1</b> Confidence intervals for proportions</a></li>
<li class="chapter" data-level="5.6.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#chi-square-test"><i class="fa fa-check"></i><b>5.6.2</b> Chi-square test</a></li>
<li class="chapter" data-level="5.6.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#sample-size-1"><i class="fa fa-check"></i><b>5.6.3</b> Sample size</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>6</b> Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="regression.html"><a href="regression.html#correlation"><i class="fa fa-check"></i><b>6.1</b> Correlation</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="regression.html"><a href="regression.html#correlation-coefficient"><i class="fa fa-check"></i><b>6.1.1</b> Correlation coefficient</a></li>
<li class="chapter" data-level="6.1.2" data-path="regression.html"><a href="regression.html#significance-testing"><i class="fa fa-check"></i><b>6.1.2</b> Significance testing</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="regression.html"><a href="regression.html#regression-1"><i class="fa fa-check"></i><b>6.2</b> Regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="regression.html"><a href="regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>6.2.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="6.2.2" data-path="regression.html"><a href="regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>6.2.2</b> Multiple linear regression</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="regression.html"><a href="regression.html#potential-problems"><i class="fa fa-check"></i><b>6.3</b> Potential problems</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="regression.html"><a href="regression.html#outliers"><i class="fa fa-check"></i><b>6.3.1</b> Outliers</a></li>
<li class="chapter" data-level="6.3.2" data-path="regression.html"><a href="regression.html#influential-observations"><i class="fa fa-check"></i><b>6.3.2</b> Influential observations</a></li>
<li class="chapter" data-level="6.3.3" data-path="regression.html"><a href="regression.html#non-linearity"><i class="fa fa-check"></i><b>6.3.3</b> Non-linearity</a></li>
<li class="chapter" data-level="6.3.4" data-path="regression.html"><a href="regression.html#non-constant-error-variance"><i class="fa fa-check"></i><b>6.3.4</b> Non-constant error variance</a></li>
<li class="chapter" data-level="6.3.5" data-path="regression.html"><a href="regression.html#non-normally-distributed-errors"><i class="fa fa-check"></i><b>6.3.5</b> Non-normally distributed errors</a></li>
<li class="chapter" data-level="6.3.6" data-path="regression.html"><a href="regression.html#correlation-of-errors"><i class="fa fa-check"></i><b>6.3.6</b> Correlation of errors</a></li>
<li class="chapter" data-level="6.3.7" data-path="regression.html"><a href="regression.html#collinearity"><i class="fa fa-check"></i><b>6.3.7</b> Collinearity</a></li>
<li class="chapter" data-level="6.3.8" data-path="regression.html"><a href="regression.html#omitted-variables"><i class="fa fa-check"></i><b>6.3.8</b> Omitted Variables</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="regression.html"><a href="regression.html#categorical-predictors"><i class="fa fa-check"></i><b>6.4</b> Categorical predictors</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="regression.html"><a href="regression.html#two-categories"><i class="fa fa-check"></i><b>6.4.1</b> Two categories</a></li>
<li class="chapter" data-level="6.4.2" data-path="regression.html"><a href="regression.html#more-than-two-categories"><i class="fa fa-check"></i><b>6.4.2</b> More than two categories</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="regression.html"><a href="regression.html#extensions-of-the-linear-model"><i class="fa fa-check"></i><b>6.5</b> Extensions of the linear model</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="regression.html"><a href="regression.html#interaction-effects"><i class="fa fa-check"></i><b>6.5.1</b> Interaction effects</a></li>
<li class="chapter" data-level="6.5.2" data-path="regression.html"><a href="regression.html#non-linear-relationships"><i class="fa fa-check"></i><b>6.5.2</b> Non-linear relationships</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="regression.html"><a href="regression.html#logistic-regression"><i class="fa fa-check"></i><b>6.6</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="regression.html"><a href="regression.html#motivation-and-intuition"><i class="fa fa-check"></i><b>6.6.1</b> Motivation and intuition</a></li>
<li class="chapter" data-level="6.6.2" data-path="regression.html"><a href="regression.html#technical-details-of-the-model"><i class="fa fa-check"></i><b>6.6.2</b> Technical details of the model</a></li>
<li class="chapter" data-level="6.6.3" data-path="regression.html"><a href="regression.html#estimation-in-r"><i class="fa fa-check"></i><b>6.6.3</b> Estimation in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html"><i class="fa fa-check"></i><b>7</b> Exploratory factor analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#introduction-2"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#steps-in-factor-analysis"><i class="fa fa-check"></i><b>7.2</b> Steps in factor analysis</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#are-the-assumptions-satisfied"><i class="fa fa-check"></i><b>7.2.1</b> Are the assumptions satisfied?</a></li>
<li class="chapter" data-level="7.2.2" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#deriving-factors"><i class="fa fa-check"></i><b>7.2.2</b> Deriving factors</a></li>
<li class="chapter" data-level="7.2.3" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#factor-interpretation"><i class="fa fa-check"></i><b>7.2.3</b> Factor interpretation</a></li>
<li class="chapter" data-level="7.2.4" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#creating-new-variables"><i class="fa fa-check"></i><b>7.2.4</b> Creating new variables</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#reliability-analysis"><i class="fa fa-check"></i><b>7.3</b> Reliability analysis</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>8</b> Simulation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="simulation.html"><a href="simulation.html#introduction-3"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="simulation.html"><a href="simulation.html#covid-19-vaccine-development"><i class="fa fa-check"></i><b>8.2</b> Covid-19 Vaccine Development</a></li>
<li class="chapter" data-level="8.3" data-path="simulation.html"><a href="simulation.html#developing-a-new-product"><i class="fa fa-check"></i><b>8.3</b> Developing a New Product</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="simulation.html"><a href="simulation.html#simulation-model"><i class="fa fa-check"></i><b>8.3.1</b> Simulation Model</a></li>
<li class="chapter" data-level="8.3.2" data-path="simulation.html"><a href="simulation.html#number-of-simulation-runs"><i class="fa fa-check"></i><b>8.3.2</b> Number of Simulation Runs</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulation.html"><a href="simulation.html#newsvendor-model"><i class="fa fa-check"></i><b>8.4</b> Newsvendor Model</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="simulation.html"><a href="simulation.html#demand-sampling"><i class="fa fa-check"></i><b>8.4.1</b> Demand Sampling</a></li>
<li class="chapter" data-level="8.4.2" data-path="simulation.html"><a href="simulation.html#order-simulation-model"><i class="fa fa-check"></i><b>8.4.2</b> Order Simulation Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="linear-programming.html"><a href="linear-programming.html"><i class="fa fa-check"></i><b>9</b> Linear Programming</a>
<ul>
<li class="chapter" data-level="9.1" data-path="linear-programming.html"><a href="linear-programming.html#introduction-4"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="linear-programming.html"><a href="linear-programming.html#production-planning"><i class="fa fa-check"></i><b>9.2</b> Production Planning</a></li>
<li class="chapter" data-level="9.3" data-path="linear-programming.html"><a href="linear-programming.html#transportation-problem"><i class="fa fa-check"></i><b>9.3</b> Transportation problem</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>10</b> Appendix</a>
<ul>
<li class="chapter" data-level="10.1" data-path="appendix.html"><a href="appendix.html#random-variables-probability-distributions"><i class="fa fa-check"></i><b>10.1</b> Random Variables &amp; Probability Distributions</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="appendix.html"><a href="appendix.html#random-variables"><i class="fa fa-check"></i><b>10.1.1</b> Random variables</a></li>
<li class="chapter" data-level="10.1.2" data-path="appendix.html"><a href="appendix.html#probability-distributions"><i class="fa fa-check"></i><b>10.1.2</b> Probability Distributions</a></li>
<li class="chapter" data-level="10.1.3" data-path="appendix.html"><a href="appendix.html#appendix-1"><i class="fa fa-check"></i><b>10.1.3</b> Appendix</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="appendix.html"><a href="appendix.html#regression-2"><i class="fa fa-check"></i><b>10.2</b> Regression</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="appendix.html"><a href="appendix.html#linear-regression"><i class="fa fa-check"></i><b>10.2.1</b> Linear regression</a></li>
<li class="chapter" data-level="10.2.2" data-path="appendix.html"><a href="appendix.html#logistic-regression-1"><i class="fa fa-check"></i><b>10.2.2</b> Logistic regression</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Business Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulation" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Simulation</h1>
<p>This Chapter is primarly based on</p>
<ul>
<li><p>Ritzman, L., Krajewski, L., Malhotra, M. &amp; Klassen, R. (2013). Foundations of Operations Management. Supplement G: Simulation. Pearson.</p></li>
<li><p>Kunnumkal, S. (2019). Simulation. In: Pochiraju, B. &amp; Seshadri, S. (2019). Essentials of Business Analytics. Pages 305-336. International Series in Operations Research and Management Science. Springer.</p></li>
</ul>
<p><a href="./Code/15-simulation.R">You can download the corresponding R-Code here</a></p>
<div id="introduction-3" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Introduction</h2>
<p>Simulation is one of the most widely used quantitative approaches to decision-making. It is the act of reproducing the behavior of a system using a model that describes the processes of the system. Once the model has been developed, the analyst can manipulate certain variables to measure the effects of changes on the operating characteristics of interest.</p>
<p>Through the reconfiguration and experimentation with the model of the system, properties concerning the behavior of the actual system or its subsystem can be inferred. In its broadest sense, simulation is a tool to evaluate the performance of a system, existing or proposed, under different configurations of interest and over long periods of real time.</p>
<p>Monte Carlo simulations are used to model the probability of different outcomes in a process that cannot easily be predicted due to the intervention of random variables. The simulation process includes data collection, random-number assignment, model formulation, and analysis.</p>
<p>Let’s illustrate this better with an example.</p>
</div>
<div id="covid-19-vaccine-development" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Covid-19 Vaccine Development</h2>
<p>We consider a pharmaceutical company, which is producing medicine, including different pills and vaccines. The company is called Pharma AG. Pharma AG has put a lot of effort into the research and development of a new COVID-19 vaccine. However, they are unsure whether to proceed with the development of the vaccine. A lot of investment is required before the company will make its first revenues. Further, they do not yet know how high the demand will be. Although Pharma AG is a locally operating company, global companies such as BioNTech/Pfizer have already brought vaccines to the local market.</p>
<p>As for many other business areas, these possibilities are difficult to test in practice. This is where simulation comes into play. The investment possibility is modeled in a simulation to test its applicability.
Simulation is applied in business to model different business scenarios which are influenced by varying demand. Other application areas are manufacturing operations, inventory management, marketing, or service operations. Using a simulation model for service operations like queueing models, the analyst actually generates customer arrivals, puts customers into waiting lines, selects the next customer to be served by using some priority discipline, serves that customer, and so on. The model keeps track of the number in line, waiting time, and the like during the simulation. It further calculates the averages and variances at the end. Simulation allows great flexibility in modeling complex systems. Experimental conditions can be controlled and alternatives can be compared.</p>
<p>The adequate design and analysis of simulation experiments are essential, as is the number of simulation-runs. Almost all simulations are therefore performed on a computer, where 1,000 or more simulation runs are easy to do. For the following simulation we will also use 1,000 simulation runs.</p>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="simulation.html#cb727-1" aria-hidden="true" tabindex="-1"></a><span class="co">#1000 simulation runs</span></span>
<span id="cb727-2"><a href="simulation.html#cb727-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span></code></pre></div>
</div>
<div id="developing-a-new-product" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Developing a New Product</h2>
<p>Suppose that Pharma AG have discovered a potential breakthrough in the laboratory and needs to decide whether to go forward to conduct clinical trials and seek FDA approval to market the vaccine. Since there are several uncertain input parameters, they decide to create and run a simulation model.</p>
<p>The main cost driver for vaccine development are total R&amp;D costs. Pharma AG don’t know the exact R&amp;D costs, but they will equally likely sum up to a total of somewhere between $600 million and $800 million.</p>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="simulation.html#cb728-1" aria-hidden="true" tabindex="-1"></a>RDcost <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">600000000</span>, <span class="dv">800000000</span>)</span></code></pre></div>
<p>The costs for clinical trial are also a non-neglectable key cost driver during vaccine development. From past vaccine developments, the company knows that the costs for clinical trial will be normally distributed with a mean of $150 million. The variance of the costs is estimated to be at $900 trillion^2.</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="simulation.html#cb729-1" aria-hidden="true" tabindex="-1"></a>clinicaltrialcost <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">150000000</span>,<span class="dv">30000000</span>)</span></code></pre></div>
<p>Since there are already COVID-19 vaccines of other pharmaceutical companies on the market, Pharma AG must calculate with a smaller market share. The current local market size is estimated to be normally distributed with a mean of 2 million people and a standard deviation of 0.4 million people. However, during the next years the market size is estimated to grow each year. The growth rate follows a triangular distribution between 2% and 6% with modus at 3%. In the first year, Pharma AG estimate gaining an 8% market share, which is anticipated to grow each year. The annual market share growth rate also follows a triangular distribution with a minimum of 15% and a maximum of 25%.
We use the package EnvStats for the triangular distribution in R.</p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="simulation.html#cb730-1" aria-hidden="true" tabindex="-1"></a>marketshare1 <span class="ot">&lt;-</span> <span class="fl">0.08</span></span>
<span id="cb730-2"><a href="simulation.html#cb730-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb730-3"><a href="simulation.html#cb730-3" aria-hidden="true" tabindex="-1"></a>marketsize1 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(n,<span class="dv">2000000</span>,<span class="dv">400000</span>),<span class="dv">0</span>)</span>
<span id="cb730-4"><a href="simulation.html#cb730-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb730-5"><a href="simulation.html#cb730-5" aria-hidden="true" tabindex="-1"></a>marketgrowthfactor2 <span class="ot">&lt;-</span> <span class="fu">rtri</span>(n, <span class="fl">0.02</span>, <span class="fl">0.06</span>, <span class="fl">0.03</span>)   <span class="co">#year 2</span></span>
<span id="cb730-6"><a href="simulation.html#cb730-6" aria-hidden="true" tabindex="-1"></a>marketsharegrowthrate2 <span class="ot">&lt;-</span> <span class="fu">rtri</span>(n, <span class="fl">0.15</span>, <span class="fl">0.25</span>, <span class="fl">0.2</span>)</span>
<span id="cb730-7"><a href="simulation.html#cb730-7" aria-hidden="true" tabindex="-1"></a>marketgrowthfactor3 <span class="ot">&lt;-</span> <span class="fu">rtri</span>(n, <span class="fl">0.02</span>, <span class="fl">0.06</span>, <span class="fl">0.03</span>)   <span class="co">#year 3</span></span>
<span id="cb730-8"><a href="simulation.html#cb730-8" aria-hidden="true" tabindex="-1"></a>marketsharegrowthrate3 <span class="ot">&lt;-</span> <span class="fu">rtri</span>(n, <span class="fl">0.15</span>, <span class="fl">0.25</span>, <span class="fl">0.2</span>)</span>
<span id="cb730-9"><a href="simulation.html#cb730-9" aria-hidden="true" tabindex="-1"></a>marketgrowthfactor4 <span class="ot">&lt;-</span> <span class="fu">rtri</span>(n, <span class="fl">0.02</span>, <span class="fl">0.06</span>, <span class="fl">0.03</span>)   <span class="co">#year 4</span></span>
<span id="cb730-10"><a href="simulation.html#cb730-10" aria-hidden="true" tabindex="-1"></a>marketsharegrowthrate4 <span class="ot">&lt;-</span> <span class="fu">rtri</span>(n, <span class="fl">0.15</span>, <span class="fl">0.25</span>, <span class="fl">0.2</span>)</span>
<span id="cb730-11"><a href="simulation.html#cb730-11" aria-hidden="true" tabindex="-1"></a>marketgrowthfactor5 <span class="ot">&lt;-</span> <span class="fu">rtri</span>(n, <span class="fl">0.02</span>, <span class="fl">0.06</span>, <span class="fl">0.03</span>)   <span class="co">#year 5</span></span>
<span id="cb730-12"><a href="simulation.html#cb730-12" aria-hidden="true" tabindex="-1"></a>marketsharegrowthrate5 <span class="ot">&lt;-</span> <span class="fu">rtri</span>(n, <span class="fl">0.15</span>, <span class="fl">0.25</span>, <span class="fl">0.2</span>)</span></code></pre></div>
<p>A monthly agreement is anticipated to generate revenue of $130 while incurring variable costs for distribution of the vaccine of $40.</p>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb731-1"><a href="simulation.html#cb731-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Deterministic input parameters</span></span>
<span id="cb731-2"><a href="simulation.html#cb731-2" aria-hidden="true" tabindex="-1"></a>revenuepm <span class="ot">&lt;-</span> <span class="dv">130</span> <span class="co">#revenue per month and unit</span></span>
<span id="cb731-3"><a href="simulation.html#cb731-3" aria-hidden="true" tabindex="-1"></a>varcostpm <span class="ot">&lt;-</span> <span class="dv">40</span>  <span class="co">#variable costs per month and unit</span></span></code></pre></div>
<div id="simulation-model" class="section level3" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Simulation Model</h3>
<p>We will set up the simulation model for Pharma AG for five years. We have already defined the input distribution for the five uncertain inputs. So now, we will add the calculations.</p>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="simulation.html#cb732-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total Project Costs</span></span>
<span id="cb732-2"><a href="simulation.html#cb732-2" aria-hidden="true" tabindex="-1"></a>projectcost <span class="ot">&lt;-</span> RDcost <span class="sc">+</span> clinicaltrialcost</span>
<span id="cb732-3"><a href="simulation.html#cb732-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Market Size per Year</span></span>
<span id="cb732-4"><a href="simulation.html#cb732-4" aria-hidden="true" tabindex="-1"></a>marketsize2 <span class="ot">&lt;-</span> marketsize1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>marketgrowthfactor2)</span>
<span id="cb732-5"><a href="simulation.html#cb732-5" aria-hidden="true" tabindex="-1"></a>marketsize3 <span class="ot">&lt;-</span> marketsize2<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>marketgrowthfactor3)</span>
<span id="cb732-6"><a href="simulation.html#cb732-6" aria-hidden="true" tabindex="-1"></a>marketsize4 <span class="ot">&lt;-</span> marketsize3<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>marketgrowthfactor4)</span>
<span id="cb732-7"><a href="simulation.html#cb732-7" aria-hidden="true" tabindex="-1"></a>marketsize5 <span class="ot">&lt;-</span> marketsize4<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>marketgrowthfactor5)</span>
<span id="cb732-8"><a href="simulation.html#cb732-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Market Share per Year</span></span>
<span id="cb732-9"><a href="simulation.html#cb732-9" aria-hidden="true" tabindex="-1"></a>marketshare2 <span class="ot">&lt;-</span> marketshare1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>marketsharegrowthrate2)</span>
<span id="cb732-10"><a href="simulation.html#cb732-10" aria-hidden="true" tabindex="-1"></a>marketshare3 <span class="ot">&lt;-</span> marketshare2<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>marketsharegrowthrate3)</span>
<span id="cb732-11"><a href="simulation.html#cb732-11" aria-hidden="true" tabindex="-1"></a>marketshare4 <span class="ot">&lt;-</span> marketshare3<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>marketsharegrowthrate4)</span>
<span id="cb732-12"><a href="simulation.html#cb732-12" aria-hidden="true" tabindex="-1"></a>marketshare5 <span class="ot">&lt;-</span> marketshare4<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>marketsharegrowthrate5)</span>
<span id="cb732-13"><a href="simulation.html#cb732-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Sales</span></span>
<span id="cb732-14"><a href="simulation.html#cb732-14" aria-hidden="true" tabindex="-1"></a>sales1 <span class="ot">&lt;-</span> marketsize1 <span class="sc">*</span> marketshare1</span>
<span id="cb732-15"><a href="simulation.html#cb732-15" aria-hidden="true" tabindex="-1"></a>sales2 <span class="ot">&lt;-</span> marketsize2 <span class="sc">*</span> marketshare2</span>
<span id="cb732-16"><a href="simulation.html#cb732-16" aria-hidden="true" tabindex="-1"></a>sales3 <span class="ot">&lt;-</span> marketsize3 <span class="sc">*</span> marketshare3</span>
<span id="cb732-17"><a href="simulation.html#cb732-17" aria-hidden="true" tabindex="-1"></a>sales4 <span class="ot">&lt;-</span> marketsize4 <span class="sc">*</span> marketshare4</span>
<span id="cb732-18"><a href="simulation.html#cb732-18" aria-hidden="true" tabindex="-1"></a>sales5 <span class="ot">&lt;-</span> marketsize5 <span class="sc">*</span> marketshare5</span>
<span id="cb732-19"><a href="simulation.html#cb732-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Annual Revenue</span></span>
<span id="cb732-20"><a href="simulation.html#cb732-20" aria-hidden="true" tabindex="-1"></a>revenue1 <span class="ot">&lt;-</span> sales1 <span class="sc">*</span> revenuepm<span class="sc">*</span><span class="dv">12</span></span>
<span id="cb732-21"><a href="simulation.html#cb732-21" aria-hidden="true" tabindex="-1"></a>revenue2 <span class="ot">&lt;-</span> sales2 <span class="sc">*</span> revenuepm<span class="sc">*</span><span class="dv">12</span></span>
<span id="cb732-22"><a href="simulation.html#cb732-22" aria-hidden="true" tabindex="-1"></a>revenue3 <span class="ot">&lt;-</span> sales3 <span class="sc">*</span> revenuepm<span class="sc">*</span><span class="dv">12</span></span>
<span id="cb732-23"><a href="simulation.html#cb732-23" aria-hidden="true" tabindex="-1"></a>revenue4 <span class="ot">&lt;-</span> sales4 <span class="sc">*</span> revenuepm<span class="sc">*</span><span class="dv">12</span></span>
<span id="cb732-24"><a href="simulation.html#cb732-24" aria-hidden="true" tabindex="-1"></a>revenue5 <span class="ot">&lt;-</span> sales5 <span class="sc">*</span> revenuepm<span class="sc">*</span><span class="dv">12</span></span>
<span id="cb732-25"><a href="simulation.html#cb732-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Annual Cost</span></span>
<span id="cb732-26"><a href="simulation.html#cb732-26" aria-hidden="true" tabindex="-1"></a>cost1 <span class="ot">&lt;-</span> sales1 <span class="sc">*</span> varcostpm<span class="sc">*</span><span class="dv">12</span></span>
<span id="cb732-27"><a href="simulation.html#cb732-27" aria-hidden="true" tabindex="-1"></a>cost2 <span class="ot">&lt;-</span> sales2 <span class="sc">*</span> varcostpm<span class="sc">*</span><span class="dv">12</span></span>
<span id="cb732-28"><a href="simulation.html#cb732-28" aria-hidden="true" tabindex="-1"></a>cost3 <span class="ot">&lt;-</span> sales3 <span class="sc">*</span> varcostpm<span class="sc">*</span><span class="dv">12</span></span>
<span id="cb732-29"><a href="simulation.html#cb732-29" aria-hidden="true" tabindex="-1"></a>cost4 <span class="ot">&lt;-</span> sales4 <span class="sc">*</span> varcostpm<span class="sc">*</span><span class="dv">12</span></span>
<span id="cb732-30"><a href="simulation.html#cb732-30" aria-hidden="true" tabindex="-1"></a>cost5 <span class="ot">&lt;-</span> sales5 <span class="sc">*</span> varcostpm<span class="sc">*</span><span class="dv">12</span></span>
<span id="cb732-31"><a href="simulation.html#cb732-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Annual Profit</span></span>
<span id="cb732-32"><a href="simulation.html#cb732-32" aria-hidden="true" tabindex="-1"></a>profit1 <span class="ot">&lt;-</span> revenue1 <span class="sc">-</span> cost1</span>
<span id="cb732-33"><a href="simulation.html#cb732-33" aria-hidden="true" tabindex="-1"></a>profit2 <span class="ot">&lt;-</span> revenue2 <span class="sc">-</span> cost2</span>
<span id="cb732-34"><a href="simulation.html#cb732-34" aria-hidden="true" tabindex="-1"></a>profit3 <span class="ot">&lt;-</span> revenue3 <span class="sc">-</span> cost3</span>
<span id="cb732-35"><a href="simulation.html#cb732-35" aria-hidden="true" tabindex="-1"></a>profit4 <span class="ot">&lt;-</span> revenue4 <span class="sc">-</span> cost4</span>
<span id="cb732-36"><a href="simulation.html#cb732-36" aria-hidden="true" tabindex="-1"></a>profit5 <span class="ot">&lt;-</span> revenue5 <span class="sc">-</span> cost5</span></code></pre></div>
<p>We further calculate the cumulative net profit for the five years as this is the output of the simulation model.</p>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="simulation.html#cb733-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cumulative Net Profit</span></span>
<span id="cb733-2"><a href="simulation.html#cb733-2" aria-hidden="true" tabindex="-1"></a>cumnetprofit1 <span class="ot">&lt;-</span> profit1 <span class="sc">-</span> projectcost</span>
<span id="cb733-3"><a href="simulation.html#cb733-3" aria-hidden="true" tabindex="-1"></a>cumnetprofit2 <span class="ot">&lt;-</span> cumnetprofit1 <span class="sc">+</span> profit2</span>
<span id="cb733-4"><a href="simulation.html#cb733-4" aria-hidden="true" tabindex="-1"></a>cumnetprofit3 <span class="ot">&lt;-</span> cumnetprofit2 <span class="sc">+</span> profit3</span>
<span id="cb733-5"><a href="simulation.html#cb733-5" aria-hidden="true" tabindex="-1"></a>cumnetprofit4 <span class="ot">&lt;-</span> cumnetprofit3 <span class="sc">+</span> profit4</span>
<span id="cb733-6"><a href="simulation.html#cb733-6" aria-hidden="true" tabindex="-1"></a>cumnetprofit5 <span class="ot">&lt;-</span> cumnetprofit4 <span class="sc">+</span> profit5</span></code></pre></div>
<p>By running the simulation 1,000 times we get a more accurate number of the cumulative net profits compared to running the simulation only once or twice. By taking the mean of all 1,000 calculated cumulative net profits, we get a value which is likely to be realistic.</p>
<p>Using this simulation, we can draw inferences about the probability of successfully investing into the COVID-19 vaccine development. The investment would be successful if the cumulative net profit after some years was positive, so that no losses were generated. Thus, we calculate the probability that the cumulative net profit after the third year is positive and illustrate it with a histogram.</p>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="simulation.html#cb734-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(cumnetprofit3)</span></code></pre></div>
<pre><code>## [1] -196094454</code></pre>
<p>For the cumulative net profit after the third year we get a negative average. The histogram below shows, that most of the profits are negative and only a little share is above zero.</p>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="simulation.html#cb736-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(cumnetprofit3, <span class="at">xlab =</span> <span class="st">&quot;Cumulative Net Profit&quot;</span>, </span>
<span id="cb736-2"><a href="simulation.html#cb736-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Cumulative Net Profit after the third year&quot;</span>, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb736-3"><a href="simulation.html#cb736-3" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(cumnetprofit3), <span class="fu">max</span>(cumnetprofit3), <span class="at">by=</span><span class="dv">500000000</span>), <span class="at">las=</span><span class="dv">1</span>, </span>
<span id="cb736-4"><a href="simulation.html#cb736-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels=</span><span class="fu">paste</span>(<span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">min</span>(cumnetprofit3), <span class="fu">max</span>(cumnetprofit3), </span>
<span id="cb736-5"><a href="simulation.html#cb736-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">by=</span><span class="dv">500000000</span>)<span class="sc">/</span><span class="dv">100000000</span>,<span class="dv">1</span>), <span class="st">&quot;million&quot;</span>, <span class="at">sep=</span><span class="st">&quot; &quot;</span>))</span>
<span id="cb736-6"><a href="simulation.html#cb736-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-415-1.png" width="672" /></p>
<p>And indeed, when computing the probability of the cumulative net profit after the third year, we get a low percentage of around 10 %.</p>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb737-1"><a href="simulation.html#cb737-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">0</span>, <span class="fu">mean</span>(cumnetprofit3), <span class="fu">sd</span>(cumnetprofit3), <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.08904253</code></pre>
<p>Let’s also calculate the mean cumulative net profit after the fifth year to see whether the mean profit is positive then.</p>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb739-1"><a href="simulation.html#cb739-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean Cumulative Net Profit after the fifth year</span></span>
<span id="cb739-2"><a href="simulation.html#cb739-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(cumnetprofit5)</span></code></pre></div>
<pre><code>## [1] 549559811</code></pre>
<p>The R output shows that the mean cumulative net profit after the fifth year is positive. Let’s also show its distribution visually with a histogram.</p>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb741-1"><a href="simulation.html#cb741-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(cumnetprofit5, <span class="at">xlab =</span> <span class="st">&quot;Cumulative Net Profit&quot;</span>, </span>
<span id="cb741-2"><a href="simulation.html#cb741-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Cumulative Net Profit after the fifth year&quot;</span>, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb741-3"><a href="simulation.html#cb741-3" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="fu">min</span>(cumnetprofit5), <span class="fu">max</span>(cumnetprofit5), <span class="at">by=</span><span class="dv">500000000</span>), <span class="at">las=</span><span class="dv">1</span>, </span>
<span id="cb741-4"><a href="simulation.html#cb741-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels=</span><span class="fu">paste</span>(<span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">min</span>(cumnetprofit5), <span class="fu">max</span>(cumnetprofit5), </span>
<span id="cb741-5"><a href="simulation.html#cb741-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">by=</span><span class="dv">500000000</span>)<span class="sc">/</span><span class="dv">100000000</span>,<span class="dv">1</span>), <span class="st">&quot;million&quot;</span>, <span class="at">sep=</span><span class="st">&quot; &quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-418-1.png" width="672" /></p>
<p>To be even more confident about the investment decision, we can compute a confidence interval.</p>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="simulation.html#cb742-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">qnorm</span>(<span class="fl">0.975</span>),<span class="dv">2</span>)</span>
<span id="cb742-2"><a href="simulation.html#cb742-2" aria-hidden="true" tabindex="-1"></a>(upper.bound <span class="ot">&lt;-</span> <span class="fu">mean</span>(cumnetprofit5) <span class="sc">+</span> z <span class="sc">*</span> (<span class="fu">sd</span>(cumnetprofit5)<span class="sc">/</span><span class="fu">sqrt</span>(n)))</span></code></pre></div>
<pre><code>## [1] 567393372</code></pre>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="simulation.html#cb744-1" aria-hidden="true" tabindex="-1"></a>(lower.bound <span class="ot">&lt;-</span> <span class="fu">mean</span>(cumnetprofit5) <span class="sc">-</span> z <span class="sc">*</span> (<span class="fu">sd</span>(cumnetprofit5)<span class="sc">/</span><span class="fu">sqrt</span>(n)))</span></code></pre></div>
<pre><code>## [1] 531726251</code></pre>
<p>The 95 % interval for the mean cumulative net profit after the fifth year shows us, in which range the profit will be in 95 % of the cases.</p>
</div>
<div id="number-of-simulation-runs" class="section level3" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Number of Simulation Runs</h3>
<p>After setting up a simulation model, we are interested in how many simulation runs are required to obtain statistically reliable results. Specifically, we want to choose the appropriate sample size so that the mean cumulative net profit after the fifth year lies within a $10,000,000 interval in 95% of the cases. For that we compute the following.</p>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="simulation.html#cb746-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sample size so that the mean cumnetprofit5 lies within a 95% confidence interval</span></span>
<span id="cb746-2"><a href="simulation.html#cb746-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">qnorm</span>(<span class="fl">0.975</span>),<span class="dv">2</span>)</span>
<span id="cb746-3"><a href="simulation.html#cb746-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the mean should lie within $10,000,000 in 95% of the cases </span></span>
<span id="cb746-4"><a href="simulation.html#cb746-4" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="dv">10000000</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb746-5"><a href="simulation.html#cb746-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">round</span>((z<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sd</span>(cumnetprofit5)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> A<span class="sc">^</span><span class="dv">2</span>, <span class="dv">0</span>)</span>
<span id="cb746-6"><a href="simulation.html#cb746-6" aria-hidden="true" tabindex="-1"></a>n</span></code></pre></div>
<pre><code>## [1] 12721</code></pre>
<p>Of course we want to know now what the new mean cumulative net profit is after the fifth year. For that, one just needs to re-run the above explained code.</p>
<pre><code>## [1] 548676504</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-421-1.png" width="672" /></p>
<p>We see that the newly calculated cumulative net profit after the fifth year is similar to the one first calculated. However, we can be more confident about this mean profit as we ran more calculations.</p>
</div>
</div>
<div id="newsvendor-model" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Newsvendor Model</h2>
<p>Pharma AG has already negotiated contracts with their buyers for the beginning of 2021. As the research and development for the Covid-19 vaccine are delayed, Pharma AG decides to buy some vaccine doses for the first month of 2021. The company expect their product to be ready for sale from February onwards. So, they only need to buy doses for one month in order to meet their customers’ requests. As the durability of vaccine is very short, the excess units, i. e. the ones which were not sold and are leftover at the end of the month, need do be disposed. The disposal costs the company $5 per unit. However, if they buy too less doses, they have to pay penalty fees of $100 per missing unit.</p>
<p>Not all contracts have been signed yet. So, the exact demand is not yet known but depends on the number of contracts to be signed. The possible demand for January 2021 can be described by the following discrete probability table.</p>
<table>
<thead>
<tr class="header">
<th><strong>Possible Demand</strong></th>
<th align="center">10,000</th>
<th align="right">12,000</th>
<th align="center">13,000</th>
<th align="right">14,000</th>
<th align="center">15,000</th>
<th align="right">16,000</th>
<th align="center">17,000</th>
<th align="right">18,000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Probability</strong></td>
<td align="center">5 %</td>
<td align="right">10 %</td>
<td align="center">15 %</td>
<td align="right">17 %</td>
<td align="center">18 %</td>
<td align="right">15 %</td>
<td align="center">13 %</td>
<td align="right">7 %</td>
</tr>
</tbody>
</table>
<p>To write that table into R we use the following code.</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="simulation.html#cb749-1" aria-hidden="true" tabindex="-1"></a>poss.demand <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10000</span>, <span class="dv">12000</span>, <span class="dv">13000</span>, <span class="dv">14000</span>, <span class="dv">15000</span>, <span class="dv">16000</span>, <span class="dv">17000</span>, <span class="dv">18000</span>)</span>
<span id="cb749-2"><a href="simulation.html#cb749-2" aria-hidden="true" tabindex="-1"></a>probabilitiy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.15</span>,<span class="fl">0.17</span>,<span class="fl">0.18</span>,<span class="fl">0.15</span>,<span class="fl">0.13</span>,<span class="fl">0.07</span>)</span></code></pre></div>
<p>Pharma AG can either buy</p>
<ul>
<li><ol style="list-style-type: decimal">
<li>15,000 doses</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>18,000 doses or</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>11,000 doses</li>
</ol></li>
</ul>
<p>of a Covid-19 vaccine. They have to order the vaccine doses already before the exact demand is known.</p>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="simulation.html#cb750-1" aria-hidden="true" tabindex="-1"></a><span class="co">#order either 15,000, 18,000, or 11,000 doses</span></span>
<span id="cb750-2"><a href="simulation.html#cb750-2" aria-hidden="true" tabindex="-1"></a>order1 <span class="ot">&lt;-</span> <span class="dv">15000</span></span>
<span id="cb750-3"><a href="simulation.html#cb750-3" aria-hidden="true" tabindex="-1"></a>order2 <span class="ot">&lt;-</span> <span class="dv">18000</span></span>
<span id="cb750-4"><a href="simulation.html#cb750-4" aria-hidden="true" tabindex="-1"></a>order3 <span class="ot">&lt;-</span> <span class="dv">11000</span></span></code></pre></div>
<div id="demand-sampling" class="section level3" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> Demand Sampling</h3>
<p>Before we define a simulation model we will sample the demand data for the first month. For that, the provided possible demand and the according probabilities are used. For the simulation we use the calculated number of simulation runs from above, which is around 12,600.</p>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="simulation.html#cb751-1" aria-hidden="true" tabindex="-1"></a>demand <span class="ot">&lt;-</span> <span class="fu">sample</span>(poss.demand, n, <span class="cn">TRUE</span>, probabilitiy)</span></code></pre></div>
<p>Further, we plot a histogram of the simulated demand to check its distribution.</p>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="simulation.html#cb752-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(demand,<span class="dv">6</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.0002</span>))</span>
<span id="cb752-2"><a href="simulation.html#cb752-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x,<span class="fu">mean</span>(demand),<span class="fu">sd</span>(demand)), <span class="at">col=</span><span class="st">&quot;darkblue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-425-1.png" width="672" /></p>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="simulation.html#cb753-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(demand)</span></code></pre></div>
<pre><code>## [1] 14633.68</code></pre>
<p>The mean demand is slightly lower than 15,000 units.</p>
</div>
<div id="order-simulation-model" class="section level3" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> Order Simulation Model</h3>
<p>Now we want to determine which of the three orders Pharma AG should place to maximize their average profit for the month. Therefore, we develop a simulation model.</p>
<p>The revenue can be calculated by multiplying the number of sold doses with the revenue per month.
However, the revenue is subject to several costs. The variable costs are determined by multiplying the number of sold units with the variable costs per month (see task 1). In addition, the disposal costs and the penalty costs must be considered.
The profit for the month then is the revenue less the variable costs, the penalty costs, and the disposal costs.</p>
<p>To run the model n times for each order option we use a for-loop from 1 to n.</p>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="simulation.html#cb755-1" aria-hidden="true" tabindex="-1"></a>Newsvendor <span class="ot">&lt;-</span> <span class="cf">function</span>(demand, order){</span>
<span id="cb755-2"><a href="simulation.html#cb755-2" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="dv">5</span>   <span class="co">#disposal cost</span></span>
<span id="cb755-3"><a href="simulation.html#cb755-3" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co">#penalty cost</span></span>
<span id="cb755-4"><a href="simulation.html#cb755-4" aria-hidden="true" tabindex="-1"></a>  revenue <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n)</span>
<span id="cb755-5"><a href="simulation.html#cb755-5" aria-hidden="true" tabindex="-1"></a>  shortage <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n)</span>
<span id="cb755-6"><a href="simulation.html#cb755-6" aria-hidden="true" tabindex="-1"></a>  leftover <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n)</span>
<span id="cb755-7"><a href="simulation.html#cb755-7" aria-hidden="true" tabindex="-1"></a>  sold <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n)</span>
<span id="cb755-8"><a href="simulation.html#cb755-8" aria-hidden="true" tabindex="-1"></a>  cost <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n)</span>
<span id="cb755-9"><a href="simulation.html#cb755-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb755-10"><a href="simulation.html#cb755-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb755-11"><a href="simulation.html#cb755-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (order <span class="sc">&gt;</span> demand[t]){</span>
<span id="cb755-12"><a href="simulation.html#cb755-12" aria-hidden="true" tabindex="-1"></a>      sold[t] <span class="ot">&lt;-</span> demand[t]</span>
<span id="cb755-13"><a href="simulation.html#cb755-13" aria-hidden="true" tabindex="-1"></a>      revenue[t] <span class="ot">&lt;-</span> sold[t] <span class="sc">*</span> revenuepm</span>
<span id="cb755-14"><a href="simulation.html#cb755-14" aria-hidden="true" tabindex="-1"></a>      cost[t] <span class="ot">&lt;-</span> sold[t] <span class="sc">*</span> varcostpm</span>
<span id="cb755-15"><a href="simulation.html#cb755-15" aria-hidden="true" tabindex="-1"></a>      shortage[t] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb755-16"><a href="simulation.html#cb755-16" aria-hidden="true" tabindex="-1"></a>      leftover[t] <span class="ot">&lt;-</span> order <span class="sc">-</span> sold[t]</span>
<span id="cb755-17"><a href="simulation.html#cb755-17" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb755-18"><a href="simulation.html#cb755-18" aria-hidden="true" tabindex="-1"></a>      sold[t] <span class="ot">&lt;-</span> order</span>
<span id="cb755-19"><a href="simulation.html#cb755-19" aria-hidden="true" tabindex="-1"></a>      revenue[t] <span class="ot">&lt;-</span> sold[t] <span class="sc">*</span> revenuepm</span>
<span id="cb755-20"><a href="simulation.html#cb755-20" aria-hidden="true" tabindex="-1"></a>      cost[t] <span class="ot">&lt;-</span> sold[t] <span class="sc">*</span> varcostpm</span>
<span id="cb755-21"><a href="simulation.html#cb755-21" aria-hidden="true" tabindex="-1"></a>      shortage[t] <span class="ot">&lt;-</span> demand[t] <span class="sc">-</span> sold[t]</span>
<span id="cb755-22"><a href="simulation.html#cb755-22" aria-hidden="true" tabindex="-1"></a>      leftover[t] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb755-23"><a href="simulation.html#cb755-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb755-24"><a href="simulation.html#cb755-24" aria-hidden="true" tabindex="-1"></a>  }  </span>
<span id="cb755-25"><a href="simulation.html#cb755-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb755-26"><a href="simulation.html#cb755-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># SAVE RESULTS OF EACH RUN</span></span>
<span id="cb755-27"><a href="simulation.html#cb755-27" aria-hidden="true" tabindex="-1"></a>  Simulation.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb755-28"><a href="simulation.html#cb755-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">Demand =</span> demand,</span>
<span id="cb755-29"><a href="simulation.html#cb755-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sold =</span> sold,</span>
<span id="cb755-30"><a href="simulation.html#cb755-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">Revenue =</span> revenue,</span>
<span id="cb755-31"><a href="simulation.html#cb755-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">VarCost =</span> cost,</span>
<span id="cb755-32"><a href="simulation.html#cb755-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">Shortage =</span> shortage,</span>
<span id="cb755-33"><a href="simulation.html#cb755-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Leftover =</span> leftover,</span>
<span id="cb755-34"><a href="simulation.html#cb755-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">Disposal.Cost =</span> leftover <span class="sc">*</span> d,</span>
<span id="cb755-35"><a href="simulation.html#cb755-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">Penalty.Cost =</span> shortage <span class="sc">*</span> p</span>
<span id="cb755-36"><a href="simulation.html#cb755-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb755-37"><a href="simulation.html#cb755-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb755-38"><a href="simulation.html#cb755-38" aria-hidden="true" tabindex="-1"></a>  Simulation.data<span class="sc">$</span>Profit <span class="ot">&lt;-</span> Simulation.data<span class="sc">$</span>Revenue </span>
<span id="cb755-39"><a href="simulation.html#cb755-39" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span> Simulation.data<span class="sc">$</span>Disposal.Cost </span>
<span id="cb755-40"><a href="simulation.html#cb755-40" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span> Simulation.data<span class="sc">$</span>Penalty.Cost </span>
<span id="cb755-41"><a href="simulation.html#cb755-41" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span> Simulation.data<span class="sc">$</span>VarCost </span>
<span id="cb755-42"><a href="simulation.html#cb755-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(Simulation.data<span class="sc">$</span>Profit))</span>
<span id="cb755-43"><a href="simulation.html#cb755-43" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>With th following code we can output the probable profit when ordering 15,000, 18,000, and 11,000 units.</p>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="simulation.html#cb756-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Newsvendor</span>(demand, order1))  <span class="co">#Profit when ordering 15,000 doses</span></span></code></pre></div>
<pre><code>## [1] 1820184</code></pre>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="simulation.html#cb758-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Newsvendor</span>(demand, order2))  <span class="co">#Profit when ordering 18,000 doses</span></span></code></pre></div>
<pre><code>## [1] 1902378</code></pre>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="simulation.html#cb760-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Newsvendor</span>(demand, order3))  <span class="co">#Profit when ordering 11,000 doses</span></span></code></pre></div>
<pre><code>## [1] 1423562</code></pre>
<p>As one can see, to order 11,000 units is the most profitable.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exploratory-factor-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-programming.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
